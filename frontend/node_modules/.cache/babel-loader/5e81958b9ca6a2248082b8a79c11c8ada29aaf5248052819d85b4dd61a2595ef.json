{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\david\\\\Documents\\\\anime_website\\\\anime_website\\\\frontend\\\\src\\\\Components\\\\Details\\\\AnimeDetails.js\",\n  _s = $RefreshSig$();\n/**\r\n * src/Components/Details/AnimeDetails.js\r\n * Description: React component for rendering details of an anime.\r\n */\n\nimport React, { useEffect, useState, useContext } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport data from '../../Context/ContextApi';\nimport AnimeEditor from '../ListEditors/AnimeEditor';\nimport animeDetailsStyles from '../../styles/pages/anime_details.module.css';\nimport modalStyles from '../../styles/components/Modal.module.css';\nimport { MONTHS } from '../../constants/filterOptions';\nimport axiosInstance from '../../utils/axiosConfig';\nimport Loader from '../../constants/Loader';\n\n/**\r\n * Functional component representing details of an anime.\r\n * @returns {JSX.Element} - Rendered anime details component.\r\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst AnimeDetails = () => {\n  _s();\n  var _animeDetails$images, _animeDetails$images2, _animeDetails$titles, _animeDetails$images3, _animeDetails$titles2, _animeDetails$release, _animeDetails$typings, _animeDetails$lengths, _animeDetails$lengths2, _animeDetails$release2, _animeDetails$release3;\n  const {\n    id\n  } = useParams();\n  const {\n    userData,\n    setUserData\n  } = useContext(data);\n  const [animeDetails, setAnimeDetails] = useState(null);\n  const [isAnimeAdded, setIsAnimeAdded] = useState(null);\n  const [charactersDetails, setCharactersDetails] = useState([]);\n  const [relationsDetails, setRelationsDetails] = useState([]);\n  const [isAnimeEditorOpen, setIsAnimeEditorOpen] = useState(false);\n  const [userProgress, setUserProgress] = useState({\n    status: 'Planning',\n    currentEpisode: 0\n  });\n  const [activeTab, setActiveTab] = useState('about');\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    const fetchAnimeDetails = async () => {\n      try {\n        // Fetch anime details\n        const animeResponse = await axiosInstance.get(`/animes/anime/${id}`);\n        setAnimeDetails(animeResponse.data);\n\n        // Only fetch user details if user is logged in\n        if (userData !== null && userData !== void 0 && userData._id) {\n          var _currentUser$animes, _currentUser$animes2;\n          const userResponse = await axiosInstance.get(`/users/${userData._id}/current`);\n          const currentUser = userResponse.data;\n          setUserData(currentUser);\n          const animeAdded = currentUser === null || currentUser === void 0 ? void 0 : (_currentUser$animes = currentUser.animes) === null || _currentUser$animes === void 0 ? void 0 : _currentUser$animes.some(anime => anime.animeId === id);\n          setIsAnimeAdded(animeAdded);\n          const existingAnimeIndex = currentUser === null || currentUser === void 0 ? void 0 : (_currentUser$animes2 = currentUser.animes) === null || _currentUser$animes2 === void 0 ? void 0 : _currentUser$animes2.findIndex(anime => anime.animeId.toString() === id.toString());\n          setAnimeDetails(animeResponse.data);\n          if (currentUser && existingAnimeIndex !== -1) {\n            setUserProgress({\n              status: currentUser.animes[existingAnimeIndex].status,\n              currentEpisode: currentUser.animes[existingAnimeIndex].currentEpisode\n            });\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching anime details:', error);\n      }\n    };\n    fetchAnimeDetails();\n  }, [id, userData, setUserData]);\n  const fetchCharacterDetails = async () => {\n    setLoading(true);\n    setCharactersDetails([]); // Clear previous characters\n\n    try {\n      const sortedCharacters = await Promise.all(((animeDetails === null || animeDetails === void 0 ? void 0 : animeDetails.characters) || []).map(async character => {\n        try {\n          const response = await axiosInstance.get(`/characters/character/${character.characterId}`);\n\n          // Immediately update state with the new character\n          setCharactersDetails(prev => {\n            // Check if character already exists to prevent duplicates\n            const existingCharacter = prev.find(c => c.characterDetails._id === response.data._id);\n            if (!existingCharacter) {\n              const newCharacter = {\n                ...character,\n                characterDetails: response.data\n              };\n\n              // Sort the characters as they are added\n              const updatedCharacters = [...prev, newCharacter].sort((a, b) => {\n                const rolePriority = ['Main', 'Supporting', 'Background'];\n                const priorityA = rolePriority.indexOf(a.role);\n                const priorityB = rolePriority.indexOf(b.role);\n                if (priorityA === priorityB) {\n                  const nameA = getFullName(a.characterDetails.names);\n                  const nameB = getFullName(b.characterDetails.names);\n                  return nameA.localeCompare(nameB);\n                }\n                return priorityA - priorityB;\n              });\n              return updatedCharacters;\n            }\n            return prev;\n          });\n          return {\n            ...character,\n            characterDetails: response.data\n          };\n        } catch (error) {\n          console.error(`Error fetching details for character ${character.characterId}:`, error.message);\n          return null;\n        }\n      }) || []);\n    } catch (error) {\n      console.error('Error fetching characters:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const fetchRelationDetails = async () => {\n    setLoading(true);\n    try {\n      const relationsWithDetails = await Promise.all([...((animeDetails === null || animeDetails === void 0 ? void 0 : animeDetails.mangaRelations.map(async relation => {\n        try {\n          const response = await axiosInstance.get(`/mangas/manga/${relation.relationId}`);\n          return {\n            ...relation,\n            relationDetails: response.data,\n            contentType: 'manga'\n          };\n        } catch (error) {\n          if (error.name === 'CanceledError') return null;\n          console.error(`Error fetching manga relation ${relation.relationId}`, error.message);\n          return null;\n        }\n      })) || []), ...((animeDetails === null || animeDetails === void 0 ? void 0 : animeDetails.animeRelations.map(async relation => {\n        try {\n          const response = await axiosInstance.get(`/animes/anime/${relation.relationId}`);\n          return {\n            ...relation,\n            relationDetails: response.data,\n            contentType: 'anime'\n          };\n        } catch (error) {\n          if (error.name === 'CanceledError') return null; // Silently handle canceled requests\n          console.error(`Error fetching anime relation ${relation.relationId}:`, error.message);\n          return null;\n        }\n      })) || [])]);\n      setRelationsDetails(relationsWithDetails);\n    } catch (error) {\n      console.error('Error fetching relations:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleTabChange = tab => {\n    setActiveTab(tab);\n    if (tab === 'characters') {\n      fetchCharacterDetails(); // Fetch characters only when the tab is 'characters'\n    }\n    if (tab === 'relations') {\n      fetchRelationDetails();\n    }\n  };\n  useEffect(() => {\n    var _animeDetails$mangaRe2, _animeDetails$animeRe2;\n    let isMounted = true;\n    const controller = new AbortController();\n    const fetchRelationDetails = async () => {\n      try {\n        var _animeDetails$mangaRe, _animeDetails$animeRe;\n        const relationsWithDetails = await Promise.all([...((animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$mangaRe = animeDetails.mangaRelations) === null || _animeDetails$mangaRe === void 0 ? void 0 : _animeDetails$mangaRe.map(async relation => {\n          if (!(relation !== null && relation !== void 0 && relation.relationId)) return null; // Skip if no relationId\n          try {\n            const response = await axiosInstance.get(`/mangas/manga/${relation.relationId}`, {\n              signal: controller.signal\n            });\n            if (!isMounted) return null;\n            return {\n              ...relation,\n              relationDetails: response.data,\n              contentType: 'manga'\n            };\n          } catch (error) {\n            if (error.name === 'CanceledError') return null; // Silently handle canceled requests\n            console.error(`Error fetching manga relation ${relation.relationId}:`, error.message);\n            return null;\n          }\n        })) || []), ...((animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$animeRe = animeDetails.animeRelations) === null || _animeDetails$animeRe === void 0 ? void 0 : _animeDetails$animeRe.map(async relation => {\n          if (!(relation !== null && relation !== void 0 && relation.relationId)) return null; // Skip if no relationId\n          try {\n            const response = await axiosInstance.get(`/animes/anime/${relation.relationId}`, {\n              signal: controller.signal\n            });\n            if (!isMounted) return null;\n            return {\n              ...relation,\n              relationDetails: response.data,\n              contentType: 'anime'\n            };\n          } catch (error) {\n            if (error.name === 'CanceledError') return null; // Silently handle canceled requests\n            console.error(`Error fetching anime relation ${relation.relationId}:`, error.message);\n            return null;\n          }\n        })) || [])]);\n        if (isMounted) {\n          setRelationsDetails(relationsWithDetails.filter(relation => relation !== null));\n        }\n      } catch (error) {\n        if (!isMounted || error.name === 'CanceledError') return;\n        console.error('Error fetching relation details:', error.message);\n      }\n    };\n    if (animeDetails && (((_animeDetails$mangaRe2 = animeDetails.mangaRelations) === null || _animeDetails$mangaRe2 === void 0 ? void 0 : _animeDetails$mangaRe2.length) > 0 || ((_animeDetails$animeRe2 = animeDetails.animeRelations) === null || _animeDetails$animeRe2 === void 0 ? void 0 : _animeDetails$animeRe2.length) > 0)) {\n      fetchRelationDetails();\n    }\n    return () => {\n      isMounted = false;\n      controller.abort();\n    };\n  }, [animeDetails]);\n  useEffect(() => {\n    if (userData !== null && userData !== void 0 && userData._id && animeDetails !== null && animeDetails !== void 0 && animeDetails._id) {\n      var _userData$animes;\n      const isAdded = (_userData$animes = userData.animes) === null || _userData$animes === void 0 ? void 0 : _userData$animes.some(anime => anime.animeId === animeDetails._id);\n      setIsAnimeAdded(isAdded);\n    }\n  }, [userData, animeDetails]);\n  if (!animeDetails) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 12\n    }, this);\n  }\n  const onAnimeDelete = animeId => {\n    // Implement logic to update the user's anime list after deletion\n    setUserData(prevUserData => {\n      const updatedUser = {\n        ...prevUserData\n      };\n      const updatedAnimes = updatedUser.animes.filter(anime => anime.animeId !== animeId);\n      updatedUser.animes = updatedAnimes;\n      return updatedUser;\n    });\n  };\n  const handleModalClose = () => {\n    setIsAnimeEditorOpen(false);\n  };\n  const openEditor = () => {\n    setIsAnimeEditorOpen(true);\n  };\n  const getFullName = names => {\n    switch (userData.characterName) {\n      case 'romaji':\n        return `${names.givenName} ${names.surName}`;\n      case 'romaji-western':\n        return `${names.surName} ${names.givenName}`;\n      case 'native':\n        return `${names.nativeName || ''}`;\n      default:\n        return `${names.givenName} ${names.surName}`;\n    }\n  };\n  const seriesTitle = titles => {\n    switch (userData.title) {\n      case 'english':\n        return titles.english || titles.romaji;\n      case 'romaji':\n        return titles.romaji || titles.english;\n      case 'native':\n        return titles.native;\n      default:\n        return titles.english || titles.romaji || titles.native || 'Unknown Title';\n    }\n  };\n\n  // Add this helper function to format the date\n  const formatDate = dateObj => {\n    if (!dateObj) return 'TBA';\n    const {\n      year,\n      month,\n      day\n    } = dateObj;\n    if (!year && !month && !day) return 'TBA';\n\n    // If we have a month, subtract 1 as array is 0-based\n    const monthName = month ? MONTHS[month - 1] : '';\n    const formattedDay = day ? day : '';\n    if (!monthName && !formattedDay) return year || 'TBA';\n    if (!formattedDay) return `${monthName} ${year || 'TBA'}`;\n    return `${monthName} ${formattedDay}, ${year || 'TBA'}`;\n  };\n  const determineSeason = startDate => {\n    if (!startDate || !startDate.month) return {\n      season: 'TBA',\n      year: (startDate === null || startDate === void 0 ? void 0 : startDate.year) || 'TBA'\n    };\n    const month = startDate.month;\n    let season;\n    if (month >= 3 && month <= 5) season = 'Spring';else if (month >= 6 && month <= 8) season = 'Summer';else if (month >= 9 && month <= 11) season = 'Fall';else season = 'Winter';\n    return {\n      season,\n      year: startDate.year || 'TBA'\n    };\n  };\n  const {\n    season,\n    year\n  } = determineSeason(animeDetails.releaseData.startDate);\n  const parseDescription = description => {\n    if (!description) return [];\n\n    // First handle <b> tags by preserving them\n    const preserveBoldTags = description.replace(/<b>/g, '###BOLDSTART###').replace(/<\\/b>/g, '###BOLDEND###');\n\n    // Handle <i> tags by preserving them\n    const preserveItalicTags = preserveBoldTags.replace(/<i>/g, '###ITALICSTART###').replace(/<\\/i>/g, '###ITALICEND###');\n\n    // Split by <br> tags\n    const paragraphs = preserveItalicTags.split(/<br>/);\n    return paragraphs.map(paragraph => {\n      // Remove closing br tags and trim whitespace\n      const cleanParagraph = paragraph.replace(/<\\/br>/g, '').trim();\n\n      // Restore <b> tags\n      return cleanParagraph.replace(/###BOLDSTART###/g, '<b>').replace(/###BOLDEND###/g, '</b>').replace(/###ITALICSTART###/g, '<i>').replace(/###ITALICEND###/g, '</i>');\n    }).filter(p => p);\n  };\n  const handleRelationClick = (contentType, relationId) => {\n    // Force a full navigation to the new page\n    window.location.href = `/${contentType}/${relationId}`;\n    // Alternative approach using navigate:\n    // navigate(`/${contentType}/${relationId}`, { replace: true });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: animeDetailsStyles.animeDetailsPage,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: animeDetailsStyles.animeHeader,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: animeDetailsStyles.bannerSection,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: (animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$images = animeDetails.images) === null || _animeDetails$images === void 0 ? void 0 : _animeDetails$images.border) || (animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$images2 = animeDetails.images) === null || _animeDetails$images2 === void 0 ? void 0 : _animeDetails$images2.image) || '',\n          alt: (animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$titles = animeDetails.titles) === null || _animeDetails$titles === void 0 ? void 0 : _animeDetails$titles.english) || 'Anime',\n          className: animeDetailsStyles.bannerImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: animeDetailsStyles.bannerOverlay\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: animeDetailsStyles.contentWrapper,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: animeDetailsStyles.posterContainer,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: (animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$images3 = animeDetails.images) === null || _animeDetails$images3 === void 0 ? void 0 : _animeDetails$images3.image) || '',\n            alt: (animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$titles2 = animeDetails.titles) === null || _animeDetails$titles2 === void 0 ? void 0 : _animeDetails$titles2.english) || 'Anime'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: animeDetailsStyles.actionButtons,\n            children: userData && (userData.role === 'admin' || userData.role === 'user') && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: isAnimeAdded ? /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: openEditor,\n                className: animeDetailsStyles.editButton,\n                children: \"Edit Progress\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: openEditor,\n                className: animeDetailsStyles.addButton,\n                children: \"Add to List\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 440,\n                columnNumber: 21\n              }, this)\n            }, void 0, false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 13\n          }, this), userData.role === 'admin' && /*#__PURE__*/_jsxDEV(Link, {\n            to: `/anime/${animeDetails._id}/update`,\n            className: animeDetailsStyles.editAnimeLink,\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: animeDetailsStyles.editAnimeButton,\n              children: \"Edit Anime\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: animeDetailsStyles.animeInfo,\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: animeDetailsStyles.animeTitle,\n            children: seriesTitle(animeDetails === null || animeDetails === void 0 ? void 0 : animeDetails.titles)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: animeDetailsStyles.quickInfo,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.quickInfoItem,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Status:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 466,\n                columnNumber: 17\n              }, this), \" \", (animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$release = animeDetails.releaseData) === null || _animeDetails$release === void 0 ? void 0 : _animeDetails$release.releaseStatus) || 'TBA']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.quickInfoItem,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Format:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 469,\n                columnNumber: 17\n              }, this), \" \", (animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$typings = animeDetails.typings) === null || _animeDetails$typings === void 0 ? void 0 : _animeDetails$typings.Format) || 'TBA']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.quickInfoItem,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Episodes:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 472,\n                columnNumber: 17\n              }, this), \" \", (animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$lengths = animeDetails.lengths) === null || _animeDetails$lengths === void 0 ? void 0 : _animeDetails$lengths.Episodes) || 'TBA']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 471,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.quickInfoItem,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Duration:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 475,\n                columnNumber: 17\n              }, this), \" \", animeDetails !== null && animeDetails !== void 0 && (_animeDetails$lengths2 = animeDetails.lengths) !== null && _animeDetails$lengths2 !== void 0 && _animeDetails$lengths2.EpisodeDuration ? `${animeDetails.lengths.EpisodeDuration} mins` : 'TBA']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.quickInfoItem,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Season:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 478,\n                columnNumber: 17\n              }, this), \" \", season, \" \", year]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 477,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.quickInfoItem,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Start Date:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 17\n              }, this), ' ', formatDate(animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$release2 = animeDetails.releaseData) === null || _animeDetails$release2 === void 0 ? void 0 : _animeDetails$release2.startDate)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.quickInfoItem,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"End Date:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 485,\n                columnNumber: 17\n              }, this), ' ', formatDate(animeDetails === null || animeDetails === void 0 ? void 0 : (_animeDetails$release3 = animeDetails.releaseData) === null || _animeDetails$release3 === void 0 ? void 0 : _animeDetails$release3.endDate)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 484,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: animeDetailsStyles.animeTabs,\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: `${animeDetailsStyles.tabButton} ${activeTab === 'about' ? animeDetailsStyles.active : ''}`,\n              onClick: () => setActiveTab('about'),\n              children: \"About\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `${animeDetailsStyles.tabButton} ${activeTab === 'characters' ? animeDetailsStyles.active : ''}`,\n              onClick: () => handleTabChange('characters'),\n              children: \"Characters\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `${animeDetailsStyles.tabButton} ${activeTab === 'relations' ? animeDetailsStyles.active : ''}`,\n              onClick: () => setActiveTab('relations'),\n              children: \"Relations\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 503,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 490,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: animeDetailsStyles.animeContent,\n      children: [activeTab === 'about' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: animeDetailsStyles.aboutContainer,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: animeDetailsStyles.metadataGrid\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: animeDetailsStyles.descriptionSection,\n          children: parseDescription(animeDetails.description).map((paragraph, index) => {\n            return /*#__PURE__*/_jsxDEV(\"p\", {\n              className: animeDetailsStyles.paragraph,\n              dangerouslySetInnerHTML: {\n                __html: paragraph\n              }\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 523,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 520,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 11\n      }, this), activeTab === 'characters' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: animeDetailsStyles.charactersContainer,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: animeDetailsStyles.charactersGrid,\n          children: loading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 534,\n            columnNumber: 17\n          }, this) : charactersDetails.map(character => /*#__PURE__*/_jsxDEV(Link, {\n            to: `/characters/${character.characterDetails._id}`,\n            className: animeDetailsStyles.characterCard,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.card2,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: animeDetailsStyles.characterImageContainer,\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: character.characterDetails.characterImage,\n                  alt: character.characterDetails.names.givenName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 544,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: animeDetailsStyles.characterRole,\n                  children: character.role\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 548,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 543,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: animeDetailsStyles.characterInfo,\n                children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: getFullName(character.characterDetails.names)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 553,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 552,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 542,\n              columnNumber: 21\n            }, this)\n          }, character.characterDetails._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 531,\n        columnNumber: 11\n      }, this), activeTab === 'relations' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: animeDetailsStyles.relationsContainer,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: animeDetailsStyles.relationsGrid,\n          children: relationsDetails.map(relation => /*#__PURE__*/_jsxDEV(\"div\", {\n            onClick: () => handleRelationClick(relation.contentType, relation.relationDetails._id),\n            className: animeDetailsStyles.relationCard,\n            style: {\n              cursor: 'pointer'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: animeDetailsStyles.card2,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: animeDetailsStyles.relationImageContainer,\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: relation.relationDetails.images.image,\n                  alt: relation.relationDetails.titles.english\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 575,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: animeDetailsStyles.relationType,\n                  children: relation.typeofRelation\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 579,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 574,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: animeDetailsStyles.relationInfo,\n                children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: seriesTitle(relation.relationDetails.titles)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 584,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 583,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 573,\n              columnNumber: 19\n            }, this)\n          }, relation.relationDetails._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 565,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 564,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 514,\n      columnNumber: 7\n    }, this), isAnimeEditorOpen && userProgress && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: modalStyles.modalOverlay,\n      onClick: handleModalClose,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: modalStyles.characterModal,\n        onClick: e => e.stopPropagation(),\n        children: /*#__PURE__*/_jsxDEV(AnimeEditor, {\n          anime: animeDetails,\n          userId: userData._id,\n          closeModal: handleModalClose,\n          onAnimeDelete: onAnimeDelete,\n          setUserData: setUserData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 596,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 595,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 415,\n    columnNumber: 5\n  }, this);\n};\n_s(AnimeDetails, \"HDgp+suSor8TiNOEAtQgU/C2aHA=\", false, function () {\n  return [useParams];\n});\n_c = AnimeDetails;\nexport default AnimeDetails;\nvar _c;\n$RefreshReg$(_c, \"AnimeDetails\");","map":{"version":3,"names":["React","useEffect","useState","useContext","useParams","Link","data","AnimeEditor","animeDetailsStyles","modalStyles","MONTHS","axiosInstance","Loader","jsxDEV","_jsxDEV","Fragment","_Fragment","AnimeDetails","_s","_animeDetails$images","_animeDetails$images2","_animeDetails$titles","_animeDetails$images3","_animeDetails$titles2","_animeDetails$release","_animeDetails$typings","_animeDetails$lengths","_animeDetails$lengths2","_animeDetails$release2","_animeDetails$release3","id","userData","setUserData","animeDetails","setAnimeDetails","isAnimeAdded","setIsAnimeAdded","charactersDetails","setCharactersDetails","relationsDetails","setRelationsDetails","isAnimeEditorOpen","setIsAnimeEditorOpen","userProgress","setUserProgress","status","currentEpisode","activeTab","setActiveTab","loading","setLoading","fetchAnimeDetails","animeResponse","get","_id","_currentUser$animes","_currentUser$animes2","userResponse","currentUser","animeAdded","animes","some","anime","animeId","existingAnimeIndex","findIndex","toString","error","console","fetchCharacterDetails","sortedCharacters","Promise","all","characters","map","character","response","characterId","prev","existingCharacter","find","c","characterDetails","newCharacter","updatedCharacters","sort","a","b","rolePriority","priorityA","indexOf","role","priorityB","nameA","getFullName","names","nameB","localeCompare","message","fetchRelationDetails","relationsWithDetails","mangaRelations","relation","relationId","relationDetails","contentType","name","animeRelations","handleTabChange","tab","_animeDetails$mangaRe2","_animeDetails$animeRe2","isMounted","controller","AbortController","_animeDetails$mangaRe","_animeDetails$animeRe","signal","filter","length","abort","_userData$animes","isAdded","children","fileName","_jsxFileName","lineNumber","columnNumber","onAnimeDelete","prevUserData","updatedUser","updatedAnimes","handleModalClose","openEditor","characterName","givenName","surName","nativeName","seriesTitle","titles","title","english","romaji","native","formatDate","dateObj","year","month","day","monthName","formattedDay","determineSeason","startDate","season","releaseData","parseDescription","description","preserveBoldTags","replace","preserveItalicTags","paragraphs","split","paragraph","cleanParagraph","trim","p","handleRelationClick","window","location","href","className","animeDetailsPage","animeHeader","bannerSection","src","images","border","image","alt","bannerImage","bannerOverlay","contentWrapper","posterContainer","actionButtons","onClick","editButton","addButton","to","editAnimeLink","editAnimeButton","animeInfo","animeTitle","quickInfo","quickInfoItem","releaseStatus","typings","Format","lengths","Episodes","EpisodeDuration","endDate","animeTabs","tabButton","active","animeContent","aboutContainer","metadataGrid","descriptionSection","index","dangerouslySetInnerHTML","__html","charactersContainer","charactersGrid","characterCard","card2","characterImageContainer","characterImage","characterRole","characterInfo","relationsContainer","relationsGrid","relationCard","style","cursor","relationImageContainer","relationType","typeofRelation","relationInfo","modalOverlay","characterModal","e","stopPropagation","userId","closeModal","_c","$RefreshReg$"],"sources":["C:/Users/david/Documents/anime_website/anime_website/frontend/src/Components/Details/AnimeDetails.js"],"sourcesContent":["/**\r\n * src/Components/Details/AnimeDetails.js\r\n * Description: React component for rendering details of an anime.\r\n */\r\n\r\nimport React, { useEffect, useState, useContext } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport data from '../../Context/ContextApi';\r\nimport AnimeEditor from '../ListEditors/AnimeEditor';\r\nimport animeDetailsStyles from '../../styles/pages/anime_details.module.css';\r\nimport modalStyles from '../../styles/components/Modal.module.css';\r\nimport { MONTHS } from '../../constants/filterOptions';\r\nimport axiosInstance from '../../utils/axiosConfig';\r\nimport Loader from '../../constants/Loader';\r\n\r\n/**\r\n * Functional component representing details of an anime.\r\n * @returns {JSX.Element} - Rendered anime details component.\r\n */\r\nconst AnimeDetails = () => {\r\n  const { id } = useParams();\r\n  const { userData, setUserData } = useContext(data);\r\n  const [animeDetails, setAnimeDetails] = useState(null);\r\n  const [isAnimeAdded, setIsAnimeAdded] = useState(null);\r\n  const [charactersDetails, setCharactersDetails] = useState([]);\r\n  const [relationsDetails, setRelationsDetails] = useState([]);\r\n  const [isAnimeEditorOpen, setIsAnimeEditorOpen] = useState(false);\r\n  const [userProgress, setUserProgress] = useState({\r\n    status: 'Planning',\r\n    currentEpisode: 0,\r\n  });\r\n\r\n  const [activeTab, setActiveTab] = useState('about');\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchAnimeDetails = async () => {\r\n      try {\r\n        // Fetch anime details\r\n        const animeResponse = await axiosInstance.get(\r\n          `/animes/anime/${id}`\r\n        );\r\n        setAnimeDetails(animeResponse.data);\r\n\r\n        // Only fetch user details if user is logged in\r\n        if (userData?._id) {\r\n          const userResponse = await axiosInstance.get(\r\n            `/users/${userData._id}/current`\r\n          );\r\n          const currentUser = userResponse.data;\r\n\r\n          setUserData(currentUser);\r\n\r\n          const animeAdded = currentUser?.animes?.some(\r\n            (anime) => anime.animeId === id\r\n          );\r\n          setIsAnimeAdded(animeAdded);\r\n\r\n          const existingAnimeIndex = currentUser?.animes?.findIndex(\r\n            (anime) => anime.animeId.toString() === id.toString()\r\n          );\r\n\r\n          setAnimeDetails(animeResponse.data);\r\n\r\n          if (currentUser && existingAnimeIndex !== -1) {\r\n            setUserProgress({\r\n              status:\r\n                currentUser.animes[existingAnimeIndex].status,\r\n              currentEpisode:\r\n                currentUser.animes[existingAnimeIndex].currentEpisode,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching anime details:', error);\r\n      }\r\n    };\r\n\r\n    fetchAnimeDetails();\r\n  }, [id, userData, setUserData]);\r\n\r\n  const fetchCharacterDetails = async () => {\r\n    setLoading(true);\r\n    setCharactersDetails([]); // Clear previous characters\r\n\r\n    try {\r\n      const sortedCharacters = await Promise.all(\r\n        (animeDetails?.characters || []).map(async (character) => {\r\n          try {\r\n            const response = await axiosInstance.get(\r\n              `/characters/character/${character.characterId}`,\r\n            );\r\n\r\n            // Immediately update state with the new character\r\n            setCharactersDetails(prev => {\r\n              // Check if character already exists to prevent duplicates\r\n              const existingCharacter = prev.find(\r\n                c => c.characterDetails._id === response.data._id\r\n              );\r\n\r\n              if (!existingCharacter) {\r\n                const newCharacter = {\r\n                  ...character,\r\n                  characterDetails: response.data,\r\n                };\r\n\r\n                // Sort the characters as they are added\r\n                const updatedCharacters = [...prev, newCharacter]\r\n                  .sort((a, b) => {\r\n                    const rolePriority = ['Main', 'Supporting', 'Background'];\r\n                    const priorityA = rolePriority.indexOf(a.role);\r\n                    const priorityB = rolePriority.indexOf(b.role);\r\n\r\n                    if (priorityA === priorityB) {\r\n                      const nameA = getFullName(a.characterDetails.names);\r\n                      const nameB = getFullName(b.characterDetails.names);\r\n                      return nameA.localeCompare(nameB);\r\n                    }\r\n\r\n                    return priorityA - priorityB;\r\n                  });\r\n\r\n                return updatedCharacters;\r\n              }\r\n\r\n              return prev;\r\n            });\r\n\r\n            return {\r\n              ...character,\r\n              characterDetails: response.data,\r\n            };\r\n          } catch (error) {\r\n            console.error(\r\n              `Error fetching details for character ${character.characterId}:`,\r\n              error.message\r\n            );\r\n            return null;\r\n          }\r\n        }) || []\r\n      );\r\n\r\n    } catch (error) {\r\n      console.error('Error fetching characters:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchRelationDetails = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const relationsWithDetails = await Promise.all([\r\n        ...(animeDetails?.mangaRelations.map(async (relation) => {\r\n          try {\r\n            const response = await axiosInstance.get(\r\n              `/mangas/manga/${relation.relationId}`,\r\n            );\r\n            return {\r\n              ...relation,\r\n              relationDetails: response.data,\r\n              contentType: 'manga',\r\n            };\r\n          } catch (error) {\r\n            if (error.name === 'CanceledError') return null;\r\n            console.error(\r\n              `Error fetching manga relation ${relation.relationId}`,\r\n              error.message\r\n            );\r\n            return null;\r\n          }\r\n        }) || []),\r\n        ...(animeDetails?.animeRelations.map(async (relation) => {\r\n          try {\r\n            const response = await axiosInstance.get(\r\n              `/animes/anime/${relation.relationId}`,\r\n            );\r\n            return {\r\n              ...relation,\r\n              relationDetails: response.data,\r\n              contentType: 'anime',\r\n            };\r\n          } catch (error) {\r\n            if (error.name === 'CanceledError') return null; // Silently handle canceled requests\r\n            console.error(\r\n              `Error fetching anime relation ${relation.relationId}:`,\r\n              error.message\r\n            );\r\n            return null;\r\n          }\r\n        }) || []),\r\n      ]);\r\n\r\n      setRelationsDetails(relationsWithDetails);\r\n    } catch (error) {\r\n      console.error('Error fetching relations:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleTabChange = (tab) => {\r\n    setActiveTab(tab);\r\n    if (tab === 'characters') {\r\n      fetchCharacterDetails(); // Fetch characters only when the tab is 'characters'\r\n    }\r\n    if (tab === 'relations') {\r\n      fetchRelationDetails();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    const controller = new AbortController();\r\n\r\n    const fetchRelationDetails = async () => {\r\n      try {\r\n        const relationsWithDetails = await Promise.all([\r\n          ...(animeDetails?.mangaRelations?.map(async (relation) => {\r\n            if (!relation?.relationId) return null; // Skip if no relationId\r\n            try {\r\n              const response = await axiosInstance.get(\r\n                `/mangas/manga/${relation.relationId}`,\r\n                { signal: controller.signal }\r\n              );\r\n              if (!isMounted) return null;\r\n              return {\r\n                ...relation,\r\n                relationDetails: response.data,\r\n                contentType: 'manga',\r\n              };\r\n            } catch (error) {\r\n              if (error.name === 'CanceledError') return null; // Silently handle canceled requests\r\n              console.error(\r\n                `Error fetching manga relation ${relation.relationId}:`,\r\n                error.message\r\n              );\r\n              return null;\r\n            }\r\n          }) || []),\r\n          ...(animeDetails?.animeRelations?.map(async (relation) => {\r\n            if (!relation?.relationId) return null; // Skip if no relationId\r\n            try {\r\n              const response = await axiosInstance.get(\r\n                `/animes/anime/${relation.relationId}`,\r\n                { signal: controller.signal }\r\n              );\r\n              if (!isMounted) return null;\r\n              return {\r\n                ...relation,\r\n                relationDetails: response.data,\r\n                contentType: 'anime',\r\n              };\r\n            } catch (error) {\r\n              if (error.name === 'CanceledError') return null; // Silently handle canceled requests\r\n              console.error(\r\n                `Error fetching anime relation ${relation.relationId}:`,\r\n                error.message\r\n              );\r\n              return null;\r\n            }\r\n          }) || []),\r\n        ]);\r\n\r\n        if (isMounted) {\r\n          setRelationsDetails(\r\n            relationsWithDetails.filter((relation) => relation !== null)\r\n          );\r\n        }\r\n      } catch (error) {\r\n        if (!isMounted || error.name === 'CanceledError') return;\r\n        console.error('Error fetching relation details:', error.message);\r\n      }\r\n    };\r\n\r\n    if (animeDetails && (animeDetails.mangaRelations?.length > 0 || animeDetails.animeRelations?.length > 0)) {\r\n      fetchRelationDetails();\r\n    }\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      controller.abort();\r\n    };\r\n  }, [animeDetails]);\r\n\r\n  useEffect(() => {\r\n    if (userData?._id && animeDetails?._id) {\r\n      const isAdded = userData.animes?.some(\r\n        (anime) => anime.animeId === animeDetails._id\r\n      );\r\n      setIsAnimeAdded(isAdded);\r\n    }\r\n  }, [userData, animeDetails]);\r\n\r\n  if (!animeDetails) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  const onAnimeDelete = (animeId) => {\r\n    // Implement logic to update the user's anime list after deletion\r\n    setUserData((prevUserData) => {\r\n      const updatedUser = { ...prevUserData };\r\n      const updatedAnimes = updatedUser.animes.filter(\r\n        (anime) => anime.animeId !== animeId\r\n      );\r\n      updatedUser.animes = updatedAnimes;\r\n      return updatedUser;\r\n    });\r\n  };\r\n\r\n  const handleModalClose = () => {\r\n    setIsAnimeEditorOpen(false);\r\n  };\r\n\r\n  const openEditor = () => {\r\n    setIsAnimeEditorOpen(true);\r\n  };\r\n\r\n  const getFullName = (names) => {\r\n    switch (userData.characterName) {\r\n      case 'romaji':\r\n        return `${names.givenName} ${names.surName}`;\r\n      case 'romaji-western':\r\n        return `${names.surName} ${names.givenName}`;\r\n      case 'native':\r\n        return `${names.nativeName || ''}`;\r\n      default:\r\n        return `${names.givenName} ${names.surName}`;\r\n    }\r\n  };\r\n\r\n  const seriesTitle = (titles) => {\r\n    switch (userData.title) {\r\n      case 'english':\r\n        return titles.english || titles.romaji\r\n      case 'romaji':\r\n        return titles.romaji || titles.english\r\n      case 'native':\r\n        return titles.native\r\n      default:\r\n        return titles.english || titles.romaji || titles.native || 'Unknown Title';\r\n    }\r\n  };\r\n\r\n  // Add this helper function to format the date\r\n  const formatDate = (dateObj) => {\r\n    if (!dateObj) return 'TBA';\r\n    const { year, month, day } = dateObj;\r\n    if (!year && !month && !day) return 'TBA';\r\n\r\n    // If we have a month, subtract 1 as array is 0-based\r\n    const monthName = month ? MONTHS[month - 1] : '';\r\n    const formattedDay = day ? day : '';\r\n\r\n    if (!monthName && !formattedDay) return year || 'TBA';\r\n    if (!formattedDay) return `${monthName} ${year || 'TBA'}`;\r\n\r\n    return `${monthName} ${formattedDay}, ${year || 'TBA'}`;\r\n  };\r\n\r\n  const determineSeason = (startDate) => {\r\n    if (!startDate || !startDate.month)\r\n      return { season: 'TBA', year: startDate?.year || 'TBA' };\r\n\r\n    const month = startDate.month;\r\n    let season;\r\n\r\n    if (month >= 3 && month <= 5) season = 'Spring';\r\n    else if (month >= 6 && month <= 8) season = 'Summer';\r\n    else if (month >= 9 && month <= 11) season = 'Fall';\r\n    else season = 'Winter';\r\n\r\n    return {\r\n      season,\r\n      year: startDate.year || 'TBA',\r\n    };\r\n  };\r\n\r\n  const { season, year } = determineSeason(animeDetails.releaseData.startDate);\r\n\r\n  const parseDescription = (description) => {\r\n    if (!description) return [];\r\n\r\n    // First handle <b> tags by preserving them\r\n    const preserveBoldTags = description.replace(/<b>/g, '###BOLDSTART###')\r\n                                      .replace(/<\\/b>/g, '###BOLDEND###');\r\n\r\n    // Handle <i> tags by preserving them\r\n    const preserveItalicTags = preserveBoldTags.replace(/<i>/g, '###ITALICSTART###')\r\n                                              .replace(/<\\/i>/g, '###ITALICEND###')\r\n\r\n    // Split by <br> tags\r\n    const paragraphs = preserveItalicTags.split(/<br>/);\r\n\r\n    return paragraphs.map(paragraph => {\r\n      // Remove closing br tags and trim whitespace\r\n      const cleanParagraph = paragraph.replace(/<\\/br>/g, '').trim();\r\n\r\n      // Restore <b> tags\r\n      return cleanParagraph.replace(/###BOLDSTART###/g, '<b>')\r\n                          .replace(/###BOLDEND###/g, '</b>')\r\n                          .replace(/###ITALICSTART###/g, '<i>')\r\n                          .replace(/###ITALICEND###/g, '</i>');\r\n    }).filter(p => p);\r\n  };\r\n\r\n  const handleRelationClick = (contentType, relationId) => {\r\n    // Force a full navigation to the new page\r\n    window.location.href = `/${contentType}/${relationId}`;\r\n    // Alternative approach using navigate:\r\n    // navigate(`/${contentType}/${relationId}`, { replace: true });\r\n  };\r\n\r\n  return (\r\n    <div className={animeDetailsStyles.animeDetailsPage}>\r\n      <div className={animeDetailsStyles.animeHeader}>\r\n        <div className={animeDetailsStyles.bannerSection}>\r\n          <img\r\n            src={animeDetails?.images?.border || animeDetails?.images?.image || ''}\r\n            alt={animeDetails?.titles?.english || 'Anime'}\r\n            className={animeDetailsStyles.bannerImage}\r\n          />\r\n          <div className={animeDetailsStyles.bannerOverlay} />\r\n        </div>\r\n\r\n        <div className={animeDetailsStyles.contentWrapper}>\r\n          <div className={animeDetailsStyles.posterContainer}>\r\n            <img\r\n              src={animeDetails?.images?.image || ''}\r\n              alt={animeDetails?.titles?.english || 'Anime'}\r\n            />\r\n            <div className={animeDetailsStyles.actionButtons}>\r\n              {userData && (userData.role === 'admin' || userData.role === 'user') && (\r\n                <>\r\n                  {isAnimeAdded ? (\r\n                      <button onClick={openEditor} className={animeDetailsStyles.editButton}>\r\n                        Edit Progress\r\n                      </button>\r\n                  ) : (\r\n                    <button onClick={openEditor} className={animeDetailsStyles.addButton}>\r\n                      Add to List\r\n                    </button>\r\n                  )}\r\n                </>\r\n              )}\r\n            </div>\r\n            {userData.role === 'admin' && (\r\n              <Link\r\n                to={`/anime/${animeDetails._id}/update`}\r\n                className={animeDetailsStyles.editAnimeLink}\r\n              >\r\n                <button className={animeDetailsStyles.editAnimeButton}>\r\n                  Edit Anime\r\n                </button>\r\n              </Link>\r\n            )}\r\n          </div>\r\n\r\n          <div className={animeDetailsStyles.animeInfo}>\r\n            <h1 className={animeDetailsStyles.animeTitle}>\r\n              {seriesTitle(animeDetails?.titles)}\r\n            </h1>\r\n\r\n            <div className={animeDetailsStyles.quickInfo}>\r\n              <div className={animeDetailsStyles.quickInfoItem}>\r\n                <span>Status:</span> {animeDetails?.releaseData?.releaseStatus || 'TBA'}\r\n              </div>\r\n              <div className={animeDetailsStyles.quickInfoItem}>\r\n                <span>Format:</span> {animeDetails?.typings?.Format || 'TBA'}\r\n              </div>\r\n              <div className={animeDetailsStyles.quickInfoItem}>\r\n                <span>Episodes:</span> {animeDetails?.lengths?.Episodes || 'TBA'}\r\n              </div>\r\n              <div className={animeDetailsStyles.quickInfoItem}>\r\n                <span>Duration:</span> {animeDetails?.lengths?.EpisodeDuration ? `${animeDetails.lengths.EpisodeDuration} mins` : 'TBA'}\r\n              </div>\r\n              <div className={animeDetailsStyles.quickInfoItem}>\r\n                <span>Season:</span> {season} {year}\r\n              </div>\r\n              <div className={animeDetailsStyles.quickInfoItem}>\r\n                <span>Start Date:</span>{' '}\r\n                {formatDate(animeDetails?.releaseData?.startDate)}\r\n              </div>\r\n              <div className={animeDetailsStyles.quickInfoItem}>\r\n                <span>End Date:</span>{' '}\r\n                {formatDate(animeDetails?.releaseData?.endDate)}\r\n              </div>\r\n            </div>\r\n\r\n            <div className={animeDetailsStyles.animeTabs}>\r\n              <button\r\n                className={`${animeDetailsStyles.tabButton} ${activeTab === 'about' ? animeDetailsStyles.active : ''}`}\r\n                onClick={() => setActiveTab('about')}\r\n              >\r\n                About\r\n              </button>\r\n              <button\r\n                className={`${animeDetailsStyles.tabButton} ${activeTab === 'characters' ? animeDetailsStyles.active : ''}`}\r\n                onClick={() => handleTabChange('characters')}\r\n              >\r\n                Characters\r\n              </button>\r\n              <button\r\n                className={`${animeDetailsStyles.tabButton} ${activeTab === 'relations' ? animeDetailsStyles.active : ''}`}\r\n                onClick={() => setActiveTab('relations')}\r\n              >\r\n                Relations\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={animeDetailsStyles.animeContent}>\r\n        {activeTab === 'about' && (\r\n          <div className={animeDetailsStyles.aboutContainer}>\r\n            <div className={animeDetailsStyles.metadataGrid}>\r\n              {/* Metadata items */}\r\n            </div>\r\n            <div className={animeDetailsStyles.descriptionSection}>\r\n              {parseDescription(animeDetails.description).map((paragraph, index) => {\r\n                return (\r\n                  <p key={index} className={animeDetailsStyles.paragraph} dangerouslySetInnerHTML={{ __html: paragraph }} />\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'characters' && (\r\n          <div className={animeDetailsStyles.charactersContainer}>\r\n            <div className={animeDetailsStyles.charactersGrid}>\r\n              {loading ? (\r\n                <Loader />\r\n              ) : (\r\n                charactersDetails.map((character) => (\r\n                  <Link\r\n                    to={`/characters/${character.characterDetails._id}`}\r\n                    key={character.characterDetails._id}\r\n                    className={animeDetailsStyles.characterCard}\r\n                  >\r\n                    <div className={animeDetailsStyles.card2}>\r\n                      <div className={animeDetailsStyles.characterImageContainer}>\r\n                        <img\r\n                          src={character.characterDetails.characterImage}\r\n                          alt={character.characterDetails.names.givenName}\r\n                        />\r\n                        <div className={animeDetailsStyles.characterRole}>\r\n                          {character.role}\r\n                        </div>\r\n                      </div>\r\n                      <div className={animeDetailsStyles.characterInfo}>\r\n                        <h4>{getFullName(character.characterDetails.names)}</h4>\r\n                      </div>\r\n                    </div>\r\n                  </Link>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'relations' && (\r\n          <div className={animeDetailsStyles.relationsContainer}>\r\n            <div className={animeDetailsStyles.relationsGrid}>\r\n              {relationsDetails.map((relation) => (\r\n                <div\r\n                  key={relation.relationDetails._id}\r\n                  onClick={() => handleRelationClick(relation.contentType, relation.relationDetails._id)}\r\n                  className={animeDetailsStyles.relationCard}\r\n                  style={{ cursor: 'pointer' }}\r\n                >\r\n                  <div className={animeDetailsStyles.card2}>\r\n                    <div className={animeDetailsStyles.relationImageContainer}>\r\n                      <img\r\n                        src={relation.relationDetails.images.image}\r\n                        alt={relation.relationDetails.titles.english}\r\n                      />\r\n                      <div className={animeDetailsStyles.relationType}>\r\n                        {relation.typeofRelation}\r\n                      </div>\r\n                    </div>\r\n                    <div className={animeDetailsStyles.relationInfo}>\r\n                      <h4>{seriesTitle(relation.relationDetails.titles)}</h4>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {isAnimeEditorOpen && userProgress && (\r\n        <div className={modalStyles.modalOverlay} onClick={handleModalClose}>\r\n          <div\r\n            className={modalStyles.characterModal}\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            <AnimeEditor\r\n              anime={animeDetails}\r\n              userId={userData._id}\r\n              closeModal={handleModalClose}\r\n              onAnimeDelete={onAnimeDelete}\r\n              setUserData={setUserData}\r\n            />\r\n          </div>\r\n        </div>\r\n)}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AnimeDetails;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}